empty trash
{ put background empty trash listener new runnable { override public void run { try { long trash folder id = account get trash folder id if trash folder id == null { timber w no trash folder configured can t empty trash return } local store local store = local store provider get instance account local folder local folder = local store get folder trash folder id local folder open boolean is trash local only = is trash local only account if is trash local only { local folder clear all messages } else { local folder destroy local only messages local folder set flags collections singleton flag deleted true } for messaging listener l : get listeners { l folder status changed account trash folder id } if is trash local only { pending command command = pending empty trash create queue pending command account command process pending commands account } } catch unavailable storage exception e { timber i failed to empty trash because storage is not available - trying again later throw new unavailable account exception e } catch exception e { timber e e empty trash failed } } });}

