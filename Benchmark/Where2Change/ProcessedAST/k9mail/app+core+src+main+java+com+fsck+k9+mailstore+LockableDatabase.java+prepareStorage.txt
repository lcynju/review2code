prepare storage
{ final storage manager storage manager = get storage manager final file database file = storage manager get database u uid provider id final file database parent dir = database file get parent file if database parent dir is file { database parent dir delete } if database parent dir exists { if database parent dir mkdirs { throw new unavailable storage exception unable to access " + database parent dir } file helper touch file database parent dir nomedia } final file attachment dir = storage manager get attachment directory u uid provider id final file attachment parent dir = attachment dir get parent file if attachment parent dir exists { attachment parent dir mkdirs file helper touch file attachment parent dir nomedia } if attachment dir exists { attachment dir mkdirs } return database file
// should be safe to unconditionally delete clashing file user is not supposed to mess with our directory noinspection result of method call ignored android seems to be unmounting the storage noinspection result of method call ignored todo maybe throw unavailable storage exception noinspection result of method call ignored todo maybe throw unavailable storage exception
